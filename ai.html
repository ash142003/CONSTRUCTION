<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Construction Materials Calculator</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .chat-container {
      height: 500px;
      overflow-y: auto;
    }
    .user-msg {
      background-color: #3b82f6;
      color: white;
      border-radius: 1rem 1rem 0 1rem;
    }
    .bot-msg {
      background-color: #e5e7eb;
      border-radius: 1rem 1rem 1rem 0;
    }
    .typing {
      display: inline-block;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background-color: #6b7280;
      animation: typing 1.5s infinite ease-in-out;
    }
    @keyframes typing {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-5px); }
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">
  <div class="bg-white rounded-xl shadow-xl w-full max-w-md">
    <div class="bg-blue-600 text-white p-4 rounded-t-xl">
      <h1 class="text-xl font-bold">ğŸ—ï¸ASWIN142003 Construction Materials Analyzer</h1>
    </div>
    
    <div id="chat" class="chat-container p-4 space-y-3"></div>
    
    <div class="p-4 border-t">
      <div id="input-area" class="flex space-x-2">
        <input id="user-input" type="text" placeholder="Type your answer..." 
               class="flex-1 border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
        <button id="send-btn" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
          Send
        </button>
      </div>
      <div id="options" class="mt-2 hidden grid grid-cols-2 gap-2"></div>
    </div>
  </div>

  <script>
    // Material calculation formulas (simplified estimates)
    const materialCalculator = {
      residential: {
        cement: (sqft) => Math.round(sqft * 0.4), // 0.4 bags per sqft
        concrete: (sqft) => Math.round(sqft * 0.1), // 0.1 cubic yards per sqft
        steel: (sqft) => Math.round(sqft * 4), // 4 kg per sqft
        bricks: (sqft) => Math.round(sqft * 8), // 8 bricks per sqft
        wood: (sqft) => Math.round(sqft * 0.05), // 0.05 cubic meters per sqft
        sand: (sqft) => Math.round(sqft * 0.05), // 0.05 cubic meters per sqft
        glass: (sqft) => Math.round(sqft * 0.1), // 0.1 sqft glass per sqft
        tiles: (sqft) => Math.round(sqft * 1.1) // 10% extra for cuts
      },
      commercial: {
        cement: (sqft) => Math.round(sqft * 0.5),
        concrete: (sqft) => Math.round(sqft * 0.15),
        steel: (sqft) => Math.round(sqft * 6),
        bricks: (sqft) => Math.round(sqft * 6),
        wood: (sqft) => Math.round(sqft * 0.03),
        sand: (sqft) => Math.round(sqft * 0.06),
        glass: (sqft) => Math.round(sqft * 0.2),
        tiles: (sqft) => Math.round(sqft * 1.1)
      },
      industrial: {
        cement: (sqft) => Math.round(sqft * 0.6),
        concrete: (sqft) => Math.round(sqft * 0.2),
        steel: (sqft) => Math.round(sqft * 8),
        bricks: (sqft) => Math.round(sqft * 4),
        wood: (sqft) => Math.round(sqft * 0.02),
        sand: (sqft) => Math.round(sqft * 0.07),
        glass: (sqft) => Math.round(sqft * 0.15),
        tiles: (sqft) => Math.round(sqft * 1.05)
      }
    };

    // Chatbot logic
    const chat = document.getElementById('chat');
    const userInput = document.getElementById('user-input');
    const sendBtn = document.getElementById('send-btn');
    const optionsDiv = document.getElementById('options');
    const inputArea = document.getElementById('input-area');

    let currentStep = 0;
    let constructionType = '';
    let squareFeet = 0;
    let budget = 0;

    const steps = [
      {
        question: "What is the square footage of your construction project?",
        handler: (answer) => {
          squareFeet = parseInt(answer);
          if (isNaN(squareFeet)) {
            addBotMessage("Please enter a valid number for square footage.");
            return false;
          }
          return true;
        }
      },
      {
        question: "What type of construction is this?",
        options: ["Residential", "Commercial", "Industrial"],
        handler: (answer) => {
          constructionType = answer.toLowerCase();
          return true;
        }
      },
      {
        question: "What is your approximate budget (in â‚¹)?",
        handler: (answer) => {
          budget = parseInt(answer);
          if (isNaN(budget)) {
            addBotMessage("Please enter a valid budget amount.");
            return false;
          }
          return true;
        }
      },
      {
        question: "Calculating material estimates...",
        handler: () => {
          setTimeout(showResults, 1500);
          return false; // Don't proceed to next step
        }
      }
    ];

    // Start the conversation
    addBotMessage("Hello! I'll help you estimate construction materials. Let's begin.");
    askQuestion();

    function askQuestion() {
      const step = steps[currentStep];
      addBotMessage(step.question);
      
      if (step.options) {
        showOptions(step.options);
      } else {
        inputArea.classList.remove('hidden');
        userInput.focus();
      }
    }

    function showOptions(options) {
      inputArea.classList.add('hidden');
      optionsDiv.innerHTML = '';
      optionsDiv.classList.remove('hidden');
      
      options.forEach(option => {
        const btn = document.createElement('button');
        btn.textContent = option;
        btn.className = 'bg-blue-100 text-blue-800 p-2 rounded-lg hover:bg-blue-200 transition';
        btn.addEventListener('click', () => handleResponse(option));
        optionsDiv.appendChild(btn);
      });
    }

    function handleResponse(answer) {
      addUserMessage(answer);
      
      const step = steps[currentStep];
      if (step.handler(answer)) {
        currentStep++;
        if (currentStep < steps.length) {
          setTimeout(askQuestion, 800);
        }
      }
    }

    function showResults() {
      const materials = materialCalculator[constructionType];
      const results = `
        <div class="bg-white p-4 rounded-lg shadow-inner">
          <h3 class="font-bold text-lg mb-2">ğŸ“ Material Estimates for ${squareFeet} sqft ${constructionType} project:</h3>
          <ul class="space-y-1">
            <li>ğŸ—ï¸ Cement: ${materials.cement(squareFeet)} bags</li>
            <li>ğŸ§± Concrete: ${materials.concrete(squareFeet)} cubic yards</li>
            <li>ğŸ”© Steel: ${materials.steel(squareFeet)} kg</li>
            <li>ğŸ§± Bricks: ${materials.bricks(squareFeet)} units</li>
            <li>ğŸªµ Wood: ${materials.wood(squareFeet)} cubic meters</li>
            <li>ğŸï¸ Sand: ${materials.sand(squareFeet)} cubic meters</li>
            <li>ğŸªŸ Glass: ${materials.glass(squareFeet)} sqft</li>
            <li>ğŸ§¿ Tiles: ${materials.tiles(squareFeet)} sqft (including 5-10% waste)</li>
          </ul>
          <div class="mt-4 p-2 bg-blue-50 rounded-lg">
            <p class="font-semibold">ğŸ’° Budget Note:</p>
            <p>Your budget of â‚¹${budget.toLocaleString()} averages â‚¹${Math.round(budget/squareFeet)} per sqft.</p>
          </div>
        </div>
      `;
      
      addBotMessage(results, false);
      addBotMessage("Would you like to calculate for another project?", false);
      
      // Reset for new calculation
      const restartBtn = document.createElement('button');
      restartBtn.textContent = "Start New Calculation";
      restartBtn.className = 'mt-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition';
      restartBtn.addEventListener('click', () => {
        currentStep = 0;
        constructionType = '';
        squareFeet = 0;
        budget = 0;
        chat.innerHTML = '';
        addBotMessage("Let's calculate materials for another project!");
        askQuestion();
        optionsDiv.classList.add('hidden');
        inputArea.classList.remove('hidden');
      });
      
      chat.appendChild(restartBtn);
    }

    function addUserMessage(text) {
      const msg = document.createElement('div');
      msg.className = 'user-msg py-2 px-4 self-end max-w-xs ml-auto';
      msg.textContent = text;
      chat.appendChild(msg);
      chat.scrollTop = chat.scrollHeight;
    }

    function addBotMessage(text, showTyping = true) {
      if (showTyping) {
        const typing = document.createElement('div');
        typing.className = 'bot-msg py-2 px-4 self-start max-w-xs mr-auto flex space-x-1';
        typing.innerHTML = '<div class="typing"></div><div class="typing"></div><div class="typing"></div>';
        chat.appendChild(typing);
        chat.scrollTop = chat.scrollHeight;
        
        setTimeout(() => {
          chat.removeChild(typing);
          const msg = document.createElement('div');
          msg.className = 'bot-msg py-2 px-4 self-start max-w-xs mr-auto';
          msg.innerHTML = text;
          chat.appendChild(msg);
          chat.scrollTop = chat.scrollHeight;
        }, 1000);
      } else {
        const msg = document.createElement('div');
        msg.className = 'bot-msg py-2 px-4 self-start max-w-xs mr-auto';
        msg.innerHTML = text;
        chat.appendChild(msg);
        chat.scrollTop = chat.scrollHeight;
      }
    }

    // Event listeners
    sendBtn.addEventListener('click', () => {
      if (userInput.value.trim()) {
        handleResponse(userInput.value.trim());
        userInput.value = '';
      }
    });

    userInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter' && userInput.value.trim()) {
        handleResponse(userInput.value.trim());
        userInput.value = '';
      }
    });
  </script>
</body>
</html>